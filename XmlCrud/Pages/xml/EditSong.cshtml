<!DOCTYPE html>
@using System.Data;
@using XmlCrud.App_Code;
@using System.Xml.Linq;
@using System.Xml;

@{
    SongMethods mySongMethods = new SongMethods();
    string file = Session["file"] as string;
    DataSet ds = mySongMethods.GetAllSongs(file);
    Session["playlistClass"] = mySongMethods;
    Session["file"] = file;
    string id = Request.QueryString["id"];
}
<html>
<head>
    <link href="~/Content/font-awesome.css" rel="stylesheet" />
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-3.0.0.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
</head>
<body>
    <div>
        <form method="POST">

            <table class="table table-bordered">
                <tr>
                    <th>Id</th>
                    <th>Artist</th>
                    <th>Title</th>
                    <th>Year</th>
                    <th>Gerne</th>
                    <th>Time</th>
                    <th>File</th>

                    @foreach (DataRow dr in ds.Tables["song"].Select("id = '" + id + "'"))
                    {
                    <tr>
                        <td>@dr["id"]</td>
                        <td><input type="text" value="@dr["artist"]" name="artist"></td>
                        <td><input type="text" value="@dr["title"]" name="title"/></td>
                        <td><input type="text" value="@dr["year"]" name="year"/></td>
                        <td><input type="text" value="@dr["gerne"]" name="gerne"/></td>
                        <td><input type="text" value="@dr["time"]" name="time"/></td>
                        <td><input type="text" value="@dr["file"]" name="file"/></td>
                    </tr>
                }

                    <input type="submit" name="keuze" value="UPDATE" />
                </table>
            </form>

            @if (IsPost)
            {
                XmlDocument xmlDoc = new XmlDocument();
                string load = Server.MapPath(@"~/App_Data/Playlist.xml");
                xmlDoc.Load(load); 

                //select 
                XmlNode artist = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/artist");
                XmlNode title = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/title");
                XmlNode year = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/year");
                XmlNode gerne = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/gerne");
                XmlNode time = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/time");
                XmlNode file_music = xmlDoc.SelectSingleNode("playlist/song[id='"+id+"']/file");
                
                artist.InnerText = Request.Form["artist"];
                title.InnerText = Request.Form["title"];
                year.InnerText = Request.Form["year"];
                gerne.InnerText = Request.Form["gerne"];
                time.InnerText = Request.Form["time"];
                file_music.InnerText = Request.Form["file"];
                
                
                xmlDoc.Save(load);
                
                Response.Redirect(@"~/index.cshtml");



            }
        </div>
    </body>
</html>
